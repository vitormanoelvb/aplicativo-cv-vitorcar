<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VitorCar | Início</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  <link rel="stylesheet" href="./assets/css/style.css">
  <link rel="stylesheet" href="./assets/css/transitions.css">
  <link rel="icon" type="image/png" href="./assets/img/favicon-vitorcar.ico">
</head>
<body class="vc-body">

  <header class="vc-header">
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark px-3">
      <a class="navbar-brand d-flex align-items-center" href="index.html">
        <img src="./assets/img/logo-miniatura-vc.png" alt="Logo VitorCar" class="vc-logo me-2">
        <span class="fw-bold">VitorCar</span>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#vcNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="vcNav">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" href="index.html">Principal</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="sobre.html">Sobre nós</a>
          </li>
        </ul>
      </div>
    </nav>
  </header>

  <main class="vc-main container py-4">
    <section class="vc-hero text-center mb-4" aria-label="Boas-vindas ao aplicativo VitorCar">
      <img src="./assets/img/logo-vitorcar.png" alt="Logo VitorCar" class="vc-main-logo mb-3">
      <h1 class="h3 mb-2">Bem-vindo ao VitorCar</h1>
      <p class="vc-hero-subtitle mb-0">
        Escolha uma função abaixo para gerenciar veículos, manutenções ou visualizar informações do sistema.
      </p>
    </section>

    <section class="vc-app-grid" aria-label="Menu principal do aplicativo">
      <div class="vc-app-grid-inner d-flex flex-wrap justify-content-center align-items-center gap-5">
        <button
          class="vc-app-button"
          type="button"
          onclick="playTransitionAndGo('gerenciamento-veiculos.html')"
          aria-label="Ir para gerenciamento de veículos"
        >
          <div class="vc-app-icon">
            <i class="bi bi-car-front-fill"></i>
          </div>
          <span class="vc-app-label">Veículos</span>
          <small class="vc-app-text">Centro de gestão de veículos</small>
        </button>

        <button
          class="vc-app-button"
          type="button"
          onclick="playTransitionAndGo('gerenciamento-manutencoes.html')"
          aria-label="Ir para gerenciamento de manutenções"
        >
          <div class="vc-app-icon">
            <i class="bi bi-wrench-adjustable-circle"></i>
          </div>
          <span class="vc-app-label">Manutenções</span>
          <small class="vc-app-text">Gestão prática de manutenções</small>
        </button>

        <button
          class="vc-app-button"
          type="button"
          onclick="playTransitionAndGo('creditos.html')"
          aria-label="Ver créditos do sistema"
        >
          <div class="vc-app-icon">
            <i class="bi bi-person-badge-fill"></i>
          </div>
          <span class="vc-app-label">Créditos</span>
          <small class="vc-app-text">Sobre o projeto e o autor</small>
        </button>
      </div>
    </section>

    <section class="vc-datatables mt-5" aria-label="Visão geral de veículos e manutenções">
      <header class="mb-3 text-center">
        <h2 class="h5 mb-0">Visão geral de veículos e manutenções</h2>
      </header>

      <div class="row g-4">

        <div class="col-12 col-lg-6">
          <div class="card vc-card-table">
            <div class="card-header">
              <h3 class="h6 mb-0">Veículos cadastrados no sistema</h3>
            </div>
            <div class="card-body p-0">
              <div class="table-responsive">
                <table class="table table-dark table-striped table-hover mb-0" id="tabela-veiculos-home">
                  <thead>
                    <tr>
                      <th scope="col">ID</th>
                      <th scope="col">Modelo</th>
                      <th scope="col">Placa</th>
                      <th scope="col">Proprietário</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td colspan="4" class="text-center text-muted">
                        Nenhum veículo cadastrado disponível para exibição no painel inicial.
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <div class="col-12 col-lg-6">
          <div class="card vc-card-table">
            <div class="card-header">
              <h3 class="h6 mb-0">Veículos em manutenção / serviços ativos</h3>
            </div>
            <div class="card-body p-0">
              <div class="table-responsive">
                <table class="table table-dark table-striped table-hover mb-0" id="tabela-manutencoes-home">
                  <thead>
                    <tr>
                      <th scope="col">ID</th>
                      <th scope="col">Veículo</th>
                      <th scope="col">Serviço</th>
                      <th scope="col">Status</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td colspan="4" class="text-center text-muted">
                        Nenhuma manutenção em andamento no momento.
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

      </div>
    </section>
  </main>

  <div id="vc-transition" class="vc-transition d-none">
    <video id="vc-transition-video" class="vc-transition-video">
      <source src="./assets/video/transition-vitorcar.mp4" type="video/mp4">
    </video>
  </div>

  <footer class="vc-footer text-center py-3">
    <div class="vc-footer-inner d-flex justify-content-center align-items-center gap-3 flex-wrap">
      <img src="./assets/img/logo-vmengine.png" alt="Logo VMEngine" class="vc-footer-logo">
      <img src="./assets/img/logo-vmsystems.png" alt="Logo VM Systems" class="vc-footer-logo">

      <small>
         © 2025 - VitorCar • Sistema de Controle de Veículos e Manutenções • Aplicativo de Controle de Veiculos • Projeto Acadêmico
      </small>

      <img src="./assets/img/logo-univale.png" alt="Logo Univale" class="vc-footer-logo">
      <img src="./assets/img/logo-sistemas-info.png" alt="Logo Sistemas de Informação" class="vc-footer-logo">
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="./assets/js/transitions.js"></script>
  <!-- usa API_BASE_URL + apiRequest -->
  <script src="./assets/js/app.js"></script>

  <script>
    async function carregarHomeVeiculos() {
      try {
        const resposta = await apiRequest("/api/veiculos");
        const veiculos = Array.isArray(resposta) ? resposta : (resposta.dados || []);
        preencherTabelaVeiculosHome(veiculos);
      } catch (error) {

      }
    }

    async function carregarHomeManutencoes() {
      try {
        const resposta = await apiRequest("/api/manutencoes");
        const manutencoes = Array.isArray(resposta) ? resposta : (resposta.dados || []);
        preencherTabelaManutencoesHome(manutencoes);
      } catch (error) {

      }
    }

    function preencherTabelaVeiculosHome(lista) {
      const tbody = document.querySelector("#tabela-veiculos-home tbody");
      tbody.innerHTML = "";

      if (!lista || lista.length === 0) {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td colspan="4" class="text-center text-muted">
            Nenhum veículo cadastrado disponível para exibição no painel inicial.
          </td>`;
        tbody.appendChild(tr);
        return;
      }

      lista.forEach((v) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${v.id_veiculo}</td>
          <td>${v.modelo}</td>
          <td>${v.placa}</td>
          <td>${v.dono}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    function preencherTabelaManutencoesHome(lista) {
      const tbody = document.querySelector("#tabela-manutencoes-home tbody");
      tbody.innerHTML = "";

      if (!lista || lista.length === 0) {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td colspan="4" class="text-center text-muted">
            Nenhuma manutenção em andamento no momento.
          </td>`;
        tbody.appendChild(tr);
        return;
      }

      lista.forEach((m) => {
        const tr = document.createElement("tr");
        const veiculoLabel = m.id_veiculo ? "ID " + m.id_veiculo : "-";
        const status = "Registrada"; 

        tr.innerHTML = `
          <td>${m.id_manutencao}</td>
          <td>${veiculoLabel}</td>
          <td>${m.descricao}</td>
          <td>${status}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      carregarHomeVeiculos();
      carregarHomeManutencoes();
    });
  </script>
</body>
</html>
